<!doctype html>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MMORPG Admin</title>
<style>
  body{font-family:system-ui,Segoe UI,Arial;margin:16px;max-width:720px}
  h2{margin-top:24px}
  button,input{font-size:16px}
  .row{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0}
  input{padding:8px;border:1px solid #ccc;border-radius:8px}
  button{padding:8px 12px;border-radius:8px;border:1px solid #888;background:#f5f5f5}
  pre{background:#111;color:#0f0;padding:12px;border-radius:8px;overflow:auto}
  .card{border:1px solid #ddd;border-radius:12px;padding:12px;margin:10px 0}
</style>

<h1>MMORPG Admin</h1>

<div class="card">
  <h2>Progreso global</h2>
  <div class="row">
    <button onclick="getProgress()">Ver progreso</button>
    <button onclick="inc(5)">+5</button>
    <button onclick="inc(100)">+100</button>
  </div>
  <div class="row">
    <input id="cur" type="number" placeholder="current" />
    <input id="goal" type="number" placeholder="goal" />
    <input id="stage" type="number" placeholder="stage" />
    <button onclick="setProgress()">Guardar</button>
  </div>
</div>

<div class="card">
  <h2>Jugadores</h2>
  <div class="row">
    <button onclick="listPlayers()">Listar</button>
  </div>
  <div class="row">
    <input id="pname" placeholder="name (único)" />
    <input id="plevel" type="number" placeholder="level" />
    <button onclick="addPlayer()">Crear/Actualizar</button>
  </div>
</div>

<h2>Salida</h2>
<pre id="out">—</pre>

<script>
const BASE = "https://mmorpgapi-490423500480.us-central1.run.app"; // ← TU URL
const OUT = document.getElementById("out");
const show = (x) => OUT.textContent = typeof x === "string" ? x : JSON.stringify(x, null, 2);

async function getProgress(){
  const r = await fetch(`${BASE}/progress`);
  show(await r.json());
}
async function inc(delta){
  const r = await fetch(`${BASE}/progress/increment`,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ delta })
  });
  show(await r.json());
}
async function setProgress(){
  const current = Number(document.getElementById("cur").value || 0);
  const goal    = Number(document.getElementById("goal").value || 0);
  const stage   = Number(document.getElementById("stage").value || 0);
  const body = {};
  if(!Number.isNaN(current) && current>0) body.current = current;
  if(!Number.isNaN(goal)    && goal>0)    body.goal    = goal;
  if(!Number.isNaN(stage))                body.stage   = stage;
  const r = await fetch(`${BASE}/progress/set`,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(body)
  });
  show(await r.json());
}
async function listPlayers(){
  const r = await fetch(`${BASE}/players`);
  show(await r.json());
}
async function addPlayer(){
  const name  = document.getElementById("pname").value || "JugadorX";
  const level = Number(document.getElementById("plevel").value || 1);
  const r = await fetch(`${BASE}/players`,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({ name, level })
  });
  show(await r.json());
}
</script>
